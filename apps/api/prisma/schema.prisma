generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/api-client"
}

datasource db {
  provider     = "postgresql"
  url          = env("DATABASE_URL")
  relationMode = "foreignKeys"
}

// Event Store tables
model EventStore {
  id            String   @id @default(cuid())
  aggregateId   String   @map("aggregate_id")
  aggregateType String   @map("aggregate_type")
  eventType     String   @map("event_type")
  eventData     Json     @map("event_data")
  eventVersion  Int      @map("event_version")
  timestamp     DateTime @default(now())

  @@unique([aggregateId, eventVersion])
  @@map("event_store")
}

model AggregateSnapshot {
  id            String   @id @default(cuid())
  aggregateId   String   @unique @map("aggregate_id")
  aggregateType String   @map("aggregate_type")
  data          Json
  version       Int
  timestamp     DateTime @default(now())

  @@map("aggregate_snapshots")
}
